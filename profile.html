<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preview</title>
    <!-- <script src="js/profile.js"></script> -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"
        integrity="sha512-bZS47S7sPOxkjU/4Bt0zrhEtWx0y0CRkhEp8IckzK+ltifIIE9EMIMTuT/mEzoIMewUINruDBIR/jJnbguonqQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

</head>

<body>
    <header id="header"></header>
    <main>
        <div class="userDetails">
            <form>
                <h2>Application-Details</h2>
                <table aria-describedby="mydesc" class="table">
                    <tr>
                        <th scope="col">
                            <label>First Name</label>
                        </th>
                        <td>
                            <label id="firstName"></label>
                        </td>
                        <th scope="col">
                            <label>Last Name</label>
                        </th>
                        <td>
                            <label id="lastName"></label>
                        </td>
                    </tr>
                    <tr>
                        <th scope="col">
                            <label>Father Name</label>
                        </th>
                        <td>
                            <label id="fatherName"></label>
                        </td>
                    </tr>
                    <tr>
                        <th scope="col">
                            <label>Date Of Birth</label>
                        </th>
                        <td>
                            <label id="dateOfBirth"></label>
                        </td>
                    </tr>
                    <tr>
                        <th scope="col">
                            <label>Mobile Number</label>
                        </th>
                        <td>
                            <label id="mobilenumber"></label>
                        </td>
                    </tr>


                    <th scope="col">
                        <label>Gender</label>
                    </th>
                    <td>
                        <label id="gender"></label>
                    </td>
                    </tr>
                    <tr>
                        <th scope="col">
                            <label>Current-Address</label>
                        </th>
                        <td>
                            <label id="currentAddress"></label>
                        </td>
                        <th scope="col">
                            <label>Permanent-Address</label>
                        </th>
                        <td>
                            <label id="permanentAddress"></label>
                        </td>
                    </tr>
                    <tr>
                        <th scope="col">
                            <label>State</label>
                        </th>
                        <td>
                            <label id="state"></label>
                        </td>
                        <th scope="col">
                            <label>Branch</label>
                        </th>
                        <td>
                            <label id="branch"></label>
                        </td>
                    </tr>
                    <tr>
                        <th scope="col">
                            <label>Religion</label>
                        </th>
                        <td>
                            <label id="religion"></label>
                        </td>
                        <th scope="col">
                            <label>Community</label>
                        </th>
                        <td>
                            <label id="community"></label>
                        </td>
                    </tr>
                    <tr>
                        <th scope="col">
                            <label>Aadhar Number</label>
                        </th>
                        <td>
                            <label id="aadharNumber"></label>
                        </td>
                    </tr>


                </table>
                <div class="submit">
                    <a href="edit.html" id="submit">Edit</a>&nbsp;&nbsp;&nbsp;&nbsp;

                    <button type="submit" id="submit"
                        value="submit">Submit</button>
                </div>
        </div>
        </form>
    </main>
    <script>

        //Get values from Personal Information File
        let userData = JSON.parse(localStorage.getItem('userData'));
        console.log("value", userData);
        console.log(userData.mobilenumber);
        document.querySelector("#firstName").innerHTML = userData.firstName;
        document.querySelector("#lastName").innerHTML = userData.lastName;
        document.querySelector("#fatherName").innerHTML = userData.fatherName;
        document.querySelector("#dateOfBirth").innerHTML = userData.DOB;
        document.querySelector("#gender").innerHTML = userData.gender;
        document.querySelector("#mobilenumber").innerHTML = userData.mobilenumber;
        document.querySelector("#currentAddress").innerHTML = userData.currentAddress;
        document.querySelector("#permanentAddress").innerHTML = userData.permanentAddress;
        document.querySelector("#state").innerHTML = userData.state;
        document.querySelector("#branch").innerHTML = userData.branch;
        document.querySelector("#religion").innerHTML = userData.religion;
        document.querySelector("#community").innerHTML = userData.community;
        document.querySelector("#aadharNumber").innerHTML = userData.aadharNumber;


        //Get Values from Edit option
        let formDetails = JSON.parse(localStorage.getItem('editform'));

        document.querySelector("#firstName").innerHTML = formDetails.firstName;
        document.querySelector("#lastName").innerHTML = formDetails.lastName;
        document.querySelector("#fatherName").innerHTML = formDetails.fatherName;
        document.querySelector("#dateOfBirth").innerHTML = formDetails.DOB;
        document.querySelector("#mobilenumber").innerHTML = userData.mobilenumber;
        document.querySelector("#gender").innerHTML = formDetails.gender;
        document.querySelector("#currentAddress").innerHTML = formDetails.currentAddress;
        document.querySelector("#permanentAddress").innerHTML = formDetails.permanentAddress;
        document.querySelector("#state").innerHTML = formDetails.state;
        document.querySelector("#branch").innerHTML = formDetails.branch;
        document.querySelector("#religion").innerHTML = formDetails.religion;
        document.querySelector("#community").innerHTML = formDetails.community;
        document.querySelector("#aadharNumber").innerHTML = formDetails.aadharNumber;




        let formObj = {
            "PersonalInformation": {
                "firstName": formDetails.firstName,
                "lastName": formDetails.lastName,
                "fatherName": formDetails.fatherName,
                "dateOfBirth": formDetails.DOB,
                "mobilenumber": formDetails.mobilenumber,
                "gender": formDetails.gender,
                "religion": formDetails.religion,
                "community": formDetails.community,
                "aadharNumber": formDetails.aadharNumber,
            },
            "address": {
                "currrentAddress": formDetails.currentAddress,
                "permanentAddress": formDetails.currentAddress,
                "state": formDetails.state,
                "branch": formDetails.district,
            }

        }
        console.log(formObj);

        try {
            // let viewApplication = {
            //     "name": registerDetails.regName,
            //     "mobilenumber": formDetails.district,
            //     "email": registerDetails.regEmail,
            //     "status": "pending"
            // }
            // console.log("View-Application", viewApplication);

            let applicationData = {
                name: formDetails.regName,
                branch: formDetails.branch,
                mobilenumber: formDetails.mobilenumber,
                // email: registerDetails.regEmail,
                status: "Pending"
            }

            const dbusername = "apikey-v2-zyhv5j7i61imeby1qya0ma2ejrc0fkf9n4e4bl3w5gn";
            const dbpassword = "ec6094ae0714dc7a5ffc50a86924bef3";
            const basicAuth = "Basic " + btoa(dbusername + ":" + dbpassword);
            const url = "https://fffdcced-9a09-44ae-aa2f-e27add7efeb7-bluemix.cloudantnosqldb.appdomain.cloud/newaccountregister";

            axios.post(url, applicationData, {
            headers: { Authorization: basicAuth }}).then(res=>{
                let data = res.data;
                console.log(data);
                alert("Please Logout Before Leaving");
            })
        } catch (err) {
            console.error(err.message);
            alert(err.message);
            alert("Unable to register");
        }





    </script>

</body>

</html>